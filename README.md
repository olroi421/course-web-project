# –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω Backend API

–°–µ—Ä–≤–µ—Ä–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω—É, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Node.js, Express.js —Ç–∞ PostgreSQL.

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

- **Node.js** - —Å–µ—Ä–≤–µ—Ä–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ JavaScript
- **Express.js** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **PostgreSQL** - —Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
- **Prisma** - ORM –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
- **JWT** - –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
- **bcryptjs** - —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
- **express-validator** - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö

## üìã –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏ —Ç–æ–≤–∞—Ä—ñ–≤
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ —Ç–æ–≤–∞—Ä–∞–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á/–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä)
- ‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- ‚úÖ –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
- ‚úÖ RESTful API

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
ecommerce-backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ controllers/          # –ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # –ú–∞—Ä—à—Ä—É—Ç–∏ API
‚îÇ   ‚îú‚îÄ‚îÄ middleware/          # –ü—Ä–æ–º—ñ–∂–Ω—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/               # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ app.js              # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma       # –°—Ö–µ–º–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îî‚îÄ‚îÄ seed.js             # –§–∞–π–ª –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
‚îú‚îÄ‚îÄ reports/                # –ó–≤—ñ—Ç–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∏—Ö —Ä–æ–±—ñ—Ç
‚îî‚îÄ‚îÄ .env                    # –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
```

## üõ† –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### –í–∏–º–æ–≥–∏
- Node.js (–≤–µ—Ä—Å—ñ—è 18+)
- npm –∞–±–æ yarn
- PostgreSQL (–≤–µ—Ä—Å—ñ—è 12+)

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
```bash
git clone <your-repo-url>
cd ecommerce-backend
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
npm install
```

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É:
```env
DATABASE_URL="postgresql://username:password@localhost:5432/ecommerce_db"
JWT_SECRET="your-super-secret-jwt-key"
PORT=3000
NODE_ENV=development
```

### 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –º—ñ–≥—Ä–∞—Ü—ñ–π
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è Prisma –∫–ª—ñ—î–Ω—Ç–∞
npx prisma generate

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π
npx prisma migrate dev --name init

# –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –±–∞–∑–∏ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
npm run db:seed
```

### 5. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –†–æ–∑—Ä–æ–±–∫–∞
npm run dev

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm start
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é: `http://localhost:3000`

## üìö API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- `POST /api/auth/register` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `POST /api/auth/login` - –í—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `GET /api/auth/profile` - –û—Ç—Ä–∏–º–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å (–ø–æ—Ç—Ä–µ–±—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó)
- `PUT /api/auth/profile` - –û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å (–ø–æ—Ç—Ä–µ–±—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó)
- `PUT /api/auth/change-password` - –ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å (–ø–æ—Ç—Ä–µ–±—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó)

### –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó
- `GET /api/categories` - –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
- `GET /api/categories/:id` - –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∑–∞ ID
- `GET /api/categories/slug/:slug` - –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∑–∞ slug
- `POST /api/categories` - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)
- `PUT /api/categories/:id` - –û–Ω–æ–≤–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)
- `DELETE /api/categories/:id` - –í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)

### –¢–æ–≤–∞—Ä–∏
- `GET /api/products` - –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ —Ç–æ–≤–∞—Ä–∏ (–∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é)
- `GET /api/products/:id` - –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–≤–∞—Ä –∑–∞ ID
- `POST /api/products` - –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–æ–≤–∞—Ä (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)
- `PUT /api/products/:id` - –û–Ω–æ–≤–∏—Ç–∏ —Ç–æ–≤–∞—Ä (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)
- `DELETE /api/products/:id` - –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

API –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î JWT —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—Ö–æ–¥—É –æ—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–æ–∫–µ–Ω —Ç–∞ –¥–æ–¥–∞–≤–∞–π—Ç–µ –π–æ–≥–æ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø–∏—Ç—ñ–≤:

```
Authorization: Bearer <your-jwt-token>
```

## üë• –¢–µ—Å—Ç–æ–≤—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É seed —Ñ–∞–π–ª—É –±—É–¥—É—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω—ñ —Ç–µ—Å—Ç–æ–≤—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ:

**–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä:**
- Email: `admin@example.com`
- –ü–∞—Ä–æ–ª—å: `admin123`

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á 1:**
- Email: `user1@example.com`
- –ü–∞—Ä–æ–ª—å: `123456`

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á 2:**
- Email: `user2@example.com`
- –ü–∞—Ä–æ–ª—å: `123456`

## üìù –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤

### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```http
POST /api/auth/register
Content-Type: application/json

{
  "email": "newuser@example.com",
  "password": "Password123",
  "firstName": "–Ü–≤–∞–Ω",
  "lastName": "–Ü–≤–∞–Ω–µ–Ω–∫–æ",
  "phone": "+380501234567"
}
```

### –í—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "user1@example.com",
  "password": "123456"
}
```

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—É (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω)
```http
POST /api/products
Authorization: Bearer <admin-token>
Content-Type: application/json

{
  "name": "–ù–æ–≤–∏–π —Ç–æ–≤–∞—Ä",
  "description": "–û–ø–∏—Å —Ç–æ–≤–∞—Ä—É",
  "price": 1999.99,
  "stock": 10,
  "categoryId": 1,
  "imageUrl": "https://example.com/image.jpg"
}
```

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
```http
GET /api/products?page=1&limit=10&category=smartphones&search=iPhone
```

## üõ† –î–æ—Å—Ç—É–ø–Ω—ñ npm scripts

```bash
npm start          # –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞
npm run dev        # –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏ (–∑ nodemon)
npm run db:migrate # –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π –ë–î
npm run db:generate # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è Prisma –∫–ª—ñ—î–Ω—Ç–∞
npm run db:seed    # –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ë–î —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
npm run db:studio  # –í—ñ–¥–∫—Ä–∏—Ç—Ç—è Prisma Studio
```

## üóÑ –°—Ö–µ–º–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

### –û—Å–Ω–æ–≤–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ:
- **users** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Å–∏—Å—Ç–µ–º–∏
- **categories** - –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–æ–≤–∞—Ä—ñ–≤
- **products** - —Ç–æ–≤–∞—Ä–∏
- **cart_items** - –µ–ª–µ–º–µ–Ω—Ç–∏ –∫–æ—à–∏–∫–∞
- **orders** - –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **order_items** - —Ç–æ–≤–∞—Ä–∏ –≤ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—ñ

### –ó–≤'—è–∑–∫–∏:
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –∑–∞–º–æ–≤–ª–µ–Ω—å (1:N)
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∫–æ—à–∏–∫–∞ (1:N)
- –ö–∞—Ç–µ–≥–æ—Ä—ñ—è –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ç–æ–≤–∞—Ä—ñ–≤ (1:N)
- –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ç–æ–≤–∞—Ä—ñ–≤ (N:M —á–µ—Ä–µ–∑ order_items)

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–æ–∑—Ä–æ–±–∫–∏

### Prisma Studio
–î–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:
```bash
npm run db:studio
```

### –ú—ñ–≥—Ä–∞—Ü—ñ—ó
–ü—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ö–µ–º–∏:
```bash
npx prisma migrate dev --name <migration_name>
```

### –°–∫–∏–¥–∞–Ω–Ω—è –ë–î
```bash
npx prisma migrate reset
```

## üö® –ë–µ–∑–ø–µ–∫–∞

- –ü–∞—Ä–æ–ª—ñ —Ö–µ—à—É—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é bcryptjs (12 rounds)
- JWT —Ç–æ–∫–µ–Ω–∏ –º–∞—é—Ç—å —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó 24 –≥–æ–¥–∏–Ω–∏
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- CORS –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –±–µ–∑–ø–µ–∫–∏
- Helmet.js –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

## üìä –í–∞–ª—ñ–¥–∞—Ü—ñ—è

### –ü–∞—Ä–æ–ª—å –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏:
- –ú—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤
- –ü—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω—É –º–∞–ª—É –ª—ñ—Ç–µ—Ä—É
- –ü—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω—É –≤–µ–ª–∏–∫—É –ª—ñ—Ç–µ—Ä—É
- –ü—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É

### Email
- –ü–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤–∞–ª—ñ–¥–Ω–∏–º email –∞–¥—Ä–µ—Å–æ–º

### –¢–µ–ª–µ—Ñ–æ–Ω
- –§–æ—Ä–º–∞—Ç: +380XXXXXXXXX

## üîç –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

API –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ HTTP –∫–æ–¥–∞–º–∏:

```json
{
  "error": "Validation error",
  "message": "Detailed error message",
  "errors": [
    {
      "field": "email",
      "message": "Please provide a valid email address"
    }
  ]
}
```

## üìà –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è

Endpoints —â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å —Å–ø–∏—Å–∫–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é:

```json
{
  "data": [...],
  "pagination": {
    "page": 1,
    "limit": 10,
    "total": 25,
    "pages": 3
  }
}
```

## üéØ –°—Ç–∞—Ç—É—Å–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å

- `PENDING` - –í –æ—á—ñ–∫—É–≤–∞–Ω–Ω—ñ
- `CONFIRMED` - –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ
- `SHIPPED` - –í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ
- `DELIVERED` - –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
- `CANCELLED` - –°–∫–∞—Å–æ–≤–∞–Ω–æ
